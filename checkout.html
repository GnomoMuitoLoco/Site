<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Servidor Magnatas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="store.css">
    <style>
        .checkout-container {
            max-width: 1200px;
            margin: 4rem auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
        }

        .checkout-main {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
        }

        .checkout-summary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            color: #fff;
            font-weight: 500;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 0 3px rgba(0, 255, 255, 0.1);
        }

        .form-input:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .coupon-row {
            display: flex;
            gap: 0.5rem;
        }

        .coupon-row .form-input {
            flex: 1;
        }

        .btn-apply-coupon {
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-apply-coupon:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .coupon-applied {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid rgba(0, 255, 0, 0.3);
            border-radius: 6px;
            color: #0f0;
            font-size: 0.85rem;
            display: none;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .summary-value {
            color: #fff;
            font-weight: 600;
        }

        .summary-total {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid rgba(0, 255, 255, 0.3);
        }

        .summary-total .summary-label {
            font-size: 1.1rem;
            color: #fff;
        }

        .summary-total .summary-value {
            font-size: 1.5rem;
            color: #00ffff;
        }

        .payment-dropdown {
            position: relative;
            margin-top: 0.75rem;
        }

        .payment-selected {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s;
        }

        .payment-selected:hover {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.05);
        }

        .payment-selected.active {
            border-color: #00ffff;
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }

        .payment-display {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .payment-icon {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .payment-info h3 {
            margin: 0;
            color: #fff;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .payment-info p {
            margin: 0.2rem 0 0 0;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.75rem;
        }

        .payment-arrow {
            color: #00ffff;
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        .payment-arrow.open {
            transform: rotate(180deg);
        }

        .payment-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #00ffff;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 10;
        }

        .payment-options.open {
            max-height: 300px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .payment-option {
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .payment-option:last-child {
            border-bottom: none;
        }

        .payment-option:hover {
            background: rgba(0, 255, 255, 0.1);
        }

        .btn-checkout {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(135deg, #00ff88 0%, #00ffff 100%);
            border: none;
            border-radius: 10px;
            color: #000;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1.5rem;
            text-transform: uppercase;
        }

        .btn-checkout:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.4);
        }

        .btn-checkout:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .alert-success {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid rgba(0, 255, 0, 0.3);
            color: #0f0;
        }

        .alert-error {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            color: #f00;
        }

        @media (max-width: 992px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }

            .checkout-summary {
                position: static;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <img src="assets/logo.png" alt="Logo Servidor Magnatas" class="nav-logo" onerror="this.style.display='none'">
                <h1>Servidor <span>Magnatas</span></h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">In√≠cio</a></li>
                <li><a href="index.html#servidores" class="nav-link">Servidores</a></li>
                <li><a href="index.html#votar" class="nav-link">Votar</a></li>
                <li><a href="equipe.html" class="nav-link">Nossa Equipe</a></li>
                <li><a href="https://servidormagnatas.notion.site/Servidor-Magnatas-Wiki-26857a7ad0ba80d8a498e7d2654ec6df" class="nav-link" target="_blank">Wiki</a></li>
                <li><a href="store.html" class="nav-link active">Loja</a></li>
            </ul>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <div class="checkout-container">
        <div class="checkout-main">
            <h1 class="section-title">
                üõí Finalizar Compra
            </h1>

            <div id="alert-container"></div>

            <!-- Aviso Importante -->
            <div class="alert alert-error" style="display: block;">
                ‚ö†Ô∏è <strong>ATEN√á√ÉO:</strong> Digite seu nick EXATAMENTE como est√° no servidor Minecraft e certifique-se de estar ONLINE para receber os itens automaticamente!
            </div>

            <div class="form-group">
                <label class="form-label">
                    üéÆ Nickname do Minecraft
                    <small style="color: rgba(255,255,255,0.6); display: block; margin-top: 0.3rem;">
                        Digite exatamente como est√° no jogo (case-sensitive)
                    </small>
                </label>
                <input type="text" id="playerNick" class="form-input" placeholder="Digite seu nick..." maxlength="16" required>
            </div>

            <div class="form-group">
                <label class="form-label">üìç Servidor Selecionado</label>
                <input type="text" id="serverName" class="form-input" readonly style="background: rgba(0, 0, 0, 0.5);">
            </div>

            <div class="form-group">
                <label class="form-label">
                    üí∞ Quantidade de MGT-Cash
                    <small style="color: rgba(255,255,255,0.6); display: block; margin-top: 0.3rem;">
                        Digite a quantidade desejada (m√≠nimo: 100)
                    </small>
                </label>
                <input type="number" id="cashQuantity" class="form-input" placeholder="Ex: 500" min="100" step="50" oninput="updateSummary()" required>
            </div>
        </div>

        <div class="checkout-summary">
            <h2 class="section-title">üìã Resumo</h2>

            <div class="summary-item">
                <span class="summary-label">Produto</span>
                <span class="summary-value" id="summaryProduct">-</span>
            </div>

            <div class="summary-item">
                <span class="summary-label">Quantidade</span>
                <span class="summary-value" id="summaryQuantity">-</span>
            </div>

            <div class="summary-item">
                <span class="summary-label">Valor Unit√°rio</span>
                <span class="summary-value" id="summaryUnitPrice">R$ 0,01</span>
            </div>

            <div class="summary-item">
                <span class="summary-label">Subtotal</span>
                <span class="summary-value" id="summarySubtotal">R$ 0,00</span>
            </div>

            <div class="summary-item" id="discountRow" style="display: none;">
                <span class="summary-label">Desconto</span>
                <span class="summary-value" style="color: #0f0;" id="summaryDiscount">- R$ 0,00</span>
            </div>

            <div class="summary-item summary-total">
                <span class="summary-label">Total</span>
                <span class="summary-value" id="summaryTotal">R$ 0,00</span>
            </div>

            <h3 class="section-title" style="margin-top: 1.5rem; font-size: 1.1rem;">
                üéüÔ∏è Cupom de Desconto
            </h3>

            <div class="coupon-row" style="margin-top: 0.75rem;">
                <input type="text" id="couponCode" class="form-input" placeholder="Digite o c√≥digo" style="flex: 1;">
                <button class="btn-apply-coupon" onclick="applyCoupon()">Aplicar</button>
            </div>
            <div id="couponApplied" class="coupon-applied"></div>

            <h3 class="section-title" style="margin-top: 1.5rem; font-size: 1.1rem;">
                üí≥ M√©todo de Pagamento
            </h3>

            <div class="payment-dropdown">
                <div class="payment-selected" id="paymentSelected" onclick="togglePaymentDropdown()">
                    <div class="payment-display">
                        <div class="payment-icon">üí≥</div>
                        <div class="payment-info">
                            <h3>Selecione o m√©todo</h3>
                            <p>Clique para escolher</p>
                        </div>
                    </div>
                    <span class="payment-arrow" id="paymentArrow">‚ñº</span>
                </div>

                <div class="payment-options" id="paymentOptions">
                    <div class="payment-option" onclick="selectPayment('paypal')">
                        <div class="payment-icon">üí∞</div>
                        <div class="payment-info">
                            <h3>PayPal</h3>
                            <p>Pagamento seguro</p>
                        </div>
                    </div>

                    <div class="payment-option" onclick="selectPayment('mercadopago')">
                        <div class="payment-icon">üíµ</div>
                        <div class="payment-info">
                            <h3>Mercado Pago</h3>
                            <p>Cart√£o ou boleto</p>
                        </div>
                    </div>

                    <div class="payment-option" onclick="selectPayment('pix')">
                        <div class="payment-icon">‚ö°</div>
                        <div class="payment-info">
                            <h3>PIX</h3>
                            <p>Instant√¢neo</p>
                        </div>
                    </div>

                    <div class="payment-option" onclick="selectPayment('gratis')">
                        <div class="payment-icon">üéÅ</div>
                        <div class="payment-info">
                            <h3>Gr√°tis (Teste)</h3>
                            <p>Pagamento de teste, entrega autom√°tica</p>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn-checkout" id="btnCheckout" onclick="processPayment()" disabled>
                Pagar Agora
            </button>

            <div class="security-badge">
                üîí Pagamento 100% Seguro
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Servidor <span>Magnatas</span></h3>
                    <p>Magia, Tecnologia e Aventura</p>
                </div>
                <div class="footer-section">
                    <h4>Links R√°pidos</h4>
                    <ul>
                        <li><a href="index.html">In√≠cio</a></li>
                        <li><a href="index.html#servidores">Servidores</a></li>
                        <li><a href="index.html#votar">Votar</a></li>
                        <li><a href="equipe.html">Nossa Equipe</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Links Externos</h4>
                    <ul>
                        <li><a href="https://servidormagnatas.notion.site/Servidor-Magnatas-Wiki-26857a7ad0ba80d8a498e7d2654ec6df" target="_blank">Wiki</a></li>
                        <li><a href="store.html">Loja</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Redes Sociais</h4>
                    <ul>
                        <li><a href="https://discord.gg/VewgTM2rNu" target="_blank">Discord</a></li>
                        <li><a href="https://www.tiktok.com/@servidormagnatas" target="_blank">TikTok</a></li>
                        <li><a href="https://www.youtube.com/@GnomoMuitoLoco" target="_blank">YouTube</a></li>
                        <li><a href="https://www.facebook.com/servidormagnatas/" target="_blank">Facebook</a></li>
                        <li><a href="https://twitter.com/ServidrMagnatas" target="_blank">Twitter</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Servidor Magnatas. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        let selectedServer = null;
        let selectedPaymentMethod = null;
        let appliedCoupon = null;
        let CASH_UNIT_PRICE = 0.01; // Default, ser√° carregado da API

        // Carregar dados da compra
        window.addEventListener('DOMContentLoaded', async () => {
            // Obter servidor da URL
            const urlParams = new URLSearchParams(window.location.search);
            selectedServer = urlParams.get('server');
            
            if (!selectedServer) {
                alert('Nenhum servidor selecionado. Redirecionando...');
                window.location.href = 'store.html';
                return;
            }

            // Carregar configura√ß√µes (pre√ßo do cash)
            await loadConfiguration();
            
            // Carregar dados do servidor
            loadServerInfo();
        });

        async function loadConfiguration() {
            try {
                const response = await fetch('backend/api_loja.php?path=config');
                const data = await response.json();
                
                if (data.success && data.data) {
                    const config = data.data;
                    // Buscar valor do MGT-Cash na configura√ß√£o
                    if (config['mgt_cash_valor']) {
                        CASH_UNIT_PRICE = parseFloat(config['mgt_cash_valor']);
                    }
                }
            } catch (error) {
                console.error('Erro ao carregar configura√ß√µes:', error);
                // Usar valor padr√£o
                CASH_UNIT_PRICE = 0.01;
            }
        }

        function loadServerInfo() {
            // Buscar dados do servidor selecionado
            fetch(`backend/api_loja.php?path=servidores&id=${selectedServer}`)
            .then(response => response.json())
            .then(data => {
                if (data.success && data.data) {
                    const server = Array.isArray(data.data) ? data.data[0] : data.data;
                    document.getElementById('serverName').value = server.nome;
                    
                    // Armazenar ID num√©rico do servidor
                    window.selectedServerId = server.id;
                    
                    // Atualizar valor unit√°rio no resumo
                    document.getElementById('summaryUnitPrice').textContent = `R$ ${CASH_UNIT_PRICE.toFixed(2)}`;
                } else {
                    // Fallback se n√£o encontrar servidor
                    document.getElementById('serverName').value = selectedServer;
                    document.getElementById('summaryUnitPrice').textContent = `R$ ${CASH_UNIT_PRICE.toFixed(2)}`;
                }
            })
            .catch(error => {
                console.error('Erro ao carregar servidor:', error);
                document.getElementById('serverName').value = selectedServer;
                document.getElementById('summaryUnitPrice').textContent = `R$ ${CASH_UNIT_PRICE.toFixed(2)}`;
            });
        }

        function updateSummary() {
            // Obter quantidade do input
            const quantityInput = document.getElementById('cashQuantity');
            const quantity = parseInt(quantityInput.value) || 0;

            // Validar m√≠nimo
            if (quantity < 100) {
                document.getElementById('summaryProduct').textContent = '-';
                document.getElementById('summaryQuantity').textContent = '-';
                document.getElementById('summarySubtotal').textContent = 'R$ 0,00';
                document.getElementById('summaryTotal').textContent = 'R$ 0,00';
                document.getElementById('discountRow').style.display = 'none';
                return;
            }

            // Calcular valores (R$ 0,01 por cash)
            const subtotal = quantity * CASH_UNIT_PRICE;
            let discount = 0;

            if (appliedCoupon) {
                if (appliedCoupon.tipo === 'percentual') {
                    discount = subtotal * (appliedCoupon.valor / 100);
                } else {
                    discount = appliedCoupon.valor;
                }
            }

            const total = subtotal - discount;

            // Atualizar display
            document.getElementById('summaryProduct').textContent = `${quantity.toLocaleString('pt-BR')} MGT-Cash`;
            document.getElementById('summaryQuantity').textContent = '1x';
            document.getElementById('summarySubtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
            
            if (discount > 0) {
                document.getElementById('discountRow').style.display = 'flex';
                document.getElementById('summaryDiscount').textContent = `- R$ ${discount.toFixed(2)}`;
            } else {
                document.getElementById('discountRow').style.display = 'none';
            }

            document.getElementById('summaryTotal').textContent = `R$ ${total.toFixed(2)}`;
        }

        function togglePaymentDropdown() {
            const options = document.getElementById('paymentOptions');
            const arrow = document.getElementById('paymentArrow');
            const selected = document.getElementById('paymentSelected');
            
            options.classList.toggle('open');
            arrow.classList.toggle('open');
            selected.classList.toggle('active');
        }

        function selectPayment(method) {
            selectedPaymentMethod = method;
            
            // Definir informa√ß√µes dos m√©todos
            const methods = {
                paypal: { icon: 'üí∞', name: 'PayPal', desc: 'Pagamento seguro' },
                mercadopago: { icon: 'üíµ', name: 'Mercado Pago', desc: 'Cart√£o ou boleto' },
                pix: { icon: '‚ö°', name: 'PIX', desc: 'Instant√¢neo' },
                gratis: { icon: 'üéÅ', name: 'Gr√°tis (Teste)', desc: 'Pagamento de teste, entrega autom√°tica' }
            };
            
            const selected = methods[method];
            
            // Atualizar display do m√©todo selecionado
            document.getElementById('paymentSelected').innerHTML = `
                <div class="payment-display">
                    <div class="payment-icon">${selected.icon}</div>
                    <div class="payment-info">
                        <h3>${selected.name}</h3>
                        <p>${selected.desc}</p>
                    </div>
                </div>
                <span class="payment-arrow" id="paymentArrow">‚ñº</span>
            `;
            
            // Fechar dropdown
            togglePaymentDropdown();

            // Habilitar bot√£o
            document.getElementById('btnCheckout').disabled = false;
        }

        // Fechar dropdown ao clicar fora
        document.addEventListener('click', function(event) {
            const dropdown = document.querySelector('.payment-dropdown');
            const options = document.getElementById('paymentOptions');
            
            if (dropdown && !dropdown.contains(event.target) && options.classList.contains('open')) {
                togglePaymentDropdown();
            }
        });

        async function applyCoupon() {
            const code = document.getElementById('couponCode').value.trim();
            if (!code) {
                showAlert('Digite um c√≥digo de cupom', 'error');
                return;
            }

            // Simular valida√ß√£o (implementar chamada real √† API)
            showAlert('Validando cupom...', 'success');
            
            // TODO: Chamar API para validar cupom
            // Por enquanto, simular cupom inv√°lido
            setTimeout(() => {
                showAlert('Cupom inv√°lido ou expirado', 'error');
            }, 1000);
        }

        async function processPayment() {
            // Valida√ß√µes
            const playerNick = document.getElementById('playerNick').value.trim();
            
            if (!playerNick) {
                showAlert('Digite seu nick do Minecraft!', 'error');
                return;
            }
            
            if (!/^[a-zA-Z0-9_]+$/.test(playerNick)) {
                showAlert('Nick cont√©m caracteres inv√°lidos! Use apenas letras, n√∫meros e _', 'error');
                return;
            }
            
            if (playerNick.length < 3 || playerNick.length > 16) {
                showAlert('Nick deve ter entre 3 e 16 caracteres!', 'error');
                return;
            }
            
            // Obter quantidade do input
            const quantityInput = document.getElementById('cashQuantity');
            const quantity = parseInt(quantityInput.value) || 0;
            
            if (quantity < 100) {
                showAlert('Digite uma quantidade m√≠nima de 100 MGT-Cash!', 'error');
                return;
            }
            
            if (!selectedPaymentMethod) {
                showAlert('Selecione um m√©todo de pagamento!', 'error');
                return;
            }

            const btnCheckout = document.getElementById('btnCheckout');
            btnCheckout.disabled = true;
            btnCheckout.textContent = 'Processando...';

            try {
                // Usar ID num√©rico do servidor (carregado dynamicamente)
                const amount = quantity * CASH_UNIT_PRICE;

                // Chamar API para processar pagamento
                const paymentResponse = await fetch('backend/process-payment.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        jogador_nick: playerNick,
                        servidor_id: window.selectedServerId || 1, // ID num√©rico do servidor
                        quantidade: quantity,
                        metodo_pagamento: selectedPaymentMethod,
                        amount: amount.toFixed(2),
                        cupom_codigo: appliedCoupon ? appliedCoupon.codigo : null
                    })
                });

                const paymentResult = await paymentResponse.json();

                if (paymentResult.success) {
                    const data = paymentResult.data;

                    // Redirecionar baseado no m√©todo
                    if (selectedPaymentMethod === 'paypal') {
                        // PayPal retorna approval_url
                        window.location.href = data.approval_url;
                    } else if (selectedPaymentMethod === 'mercadopago') {
                        // Mercado Pago retorna init_point
                        window.location.href = data.init_point;
                    } else if (selectedPaymentMethod === 'pix') {
                        // PIX retorna qr_code e transaction_id
                        const params = new URLSearchParams({
                            transaction_id: data.transaction_id,
                            qr_code: data.qr_code,
                            pix_key: data.pix_key
                        });
                        window.location.href = `checkout-pix-waiting.html?${params.toString()}`;
                    } else if (selectedPaymentMethod === 'gratis') {
                        // Gr√°tis apenas confirma pagamento
                        showAlert('Pagamento de teste confirmado! Itens ser√£o entregues automaticamente.', 'success');
                        btnCheckout.disabled = false;
                        btnCheckout.textContent = 'Pagar Agora';
                    }
                } else {
                    showAlert(paymentResult.error || 'Erro ao processar pagamento', 'error');
                    btnCheckout.disabled = false;
                    btnCheckout.textContent = 'Pagar Agora';
                }

            } catch (error) {
                console.error('Erro:', error);
                showAlert('Erro ao conectar com o servidor: ' + error.message, 'error');
                btnCheckout.disabled = false;
                btnCheckout.textContent = 'Pagar Agora';
            }
        }

        function showAlert(message, type) {
            const container = document.getElementById('alert-container');
            container.innerHTML = `<div class="alert alert-${type}">${message}</div>`;
            container.firstChild.style.display = 'block';

            setTimeout(() => {
                if (container.firstChild) {
                    container.firstChild.style.display = 'none';
                }
            }, 5000);
        }

        // Hamburger menu
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');

        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            });
        });
    </script>
</body>
</html>
